<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ç®¡ç†å¾Œå°</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<div class="container">
    <div class="topbar">
        <h1>ç®¡ç†å¾Œå°</h1>
        <div>
            <a href="/">ğŸ  å›é¦–é </a> |
            <a href="/admin/add">â• æ–°å¢èª²ç¨‹</a> |
            <a href="/logout">ç™»å‡º</a>
        </div>
    </div>

    <hr>

    {% for c in courses %}
        <h3>{{ c.course_date }} {{ c.start_time }}-{{ c.end_time }}ï½œ{{ c.course_name }}</h3>
        <p>å‰©é¤˜åé¡ï¼š{{ c.remaining }} / {{ c.capacity }}</p>

        <p>
            <a href="/admin/edit/{{ c.id }}">âœï¸ ä¿®æ”¹èª²ç¨‹</a>
        </p>

        <form method="post" action="/admin/delete/{{ c.id }}"
              onsubmit="return confirm('ç¢ºå®šè¦åˆªé™¤é€™å ‚èª²å—ï¼Ÿæ‰€æœ‰å ±åè³‡æ–™ä¹Ÿæœƒä¸€èµ·åˆªé™¤ï¼');">
            <button class="danger">åˆªé™¤èª²ç¨‹</button>
        </form>

        <h4>å ±ååå–®</h4>
        <ul>
            {% for r in Registration.query.filter_by(course_id=c.id).all() %}
                <li>
                    {{ r.name }}
                    {% if r.role == "student" %}
                        | å­¸ç”Ÿ{% if r.student_id %}ï¼ˆå­¸è™Ÿï¼š{{ r.student_id }}ï¼‰{% endif %}
                    {% elif r.role == "teacher" %}
                        | è€å¸«{% if r.unit %}ï¼ˆå–®ä½ï¼š{{ r.unit }}ï¼‰{% endif %}
                    {% endif %}
                    {% if r.email %} | {{ r.email }}{% endif %}
                    | {{ r.phone }}

                    <form method="POST" action="/admin/registration/delete/{{ r.id }}" style="display:inline;">
                        <button type="submit" onclick="return confirm('ç¢ºå®šè¦åˆªé™¤é€™ç­†å ±åå—ï¼Ÿ');">åˆªé™¤å ±å</button>
                    </form>
                </li>
            {% else %}
                <li>ç›®å‰å°šç„¡äººå ±å</li>
            {% endfor %}
        </ul>

        <hr>
    {% endfor %}
</div>

</body>
</html>
